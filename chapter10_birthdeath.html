---
layout: chapter
title: Introduction to birth-death models
---
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>
<div id="TOC">
<ul>
<li><a href="#chapter-10-introduction-to-birth-death-models">Chapter 10: Introduction to birth-death models</a><ul>
<li><a href="#section-10.1-plant-diversity-imbalance">Section 10.1: Plant diversity imbalance</a></li>
<li><a href="#section-10.2-the-birth-death-model">Section 10.2: The birth-death model</a></li>
<li><a href="#section-10.3-birth-death-models-and-phylogenetic-trees">Section 10.3: Birth-death models and phylogenetic trees</a></li>
<li><a href="#section-10.4-simulating-birth-death-trees">Section 10.4: Simulating birth-death trees</a></li>
<li><a href="#section-10.5-tree-topology-tree-shape-and-tree-balance-under-a-birth-death-model">Section 10.5: Tree topology, tree shape, and tree balance under a birth-death model</a></li>
<li><a href="#section-10.6-lineage-through-time-plots">Section 10.6: Lineage-through-time plots</a></li>
<li><a href="#section-10.7-chapter-summary">Section 10.7: Chapter Summary</a></li>
<li><a href="#references">References</a></li>
</ul></li>
</ul>
</div>
<div>
<p><a href="{{site.baseurl}}/pdf/chapter10_birthdeath.pdf">pdf version</a></p>
</div>

<h1 id="chapter-10-introduction-to-birth-death-models">Chapter 10: Introduction to birth-death models</h1>
<h2 id="section-10.1-plant-diversity-imbalance">Section 10.1: Plant diversity imbalance</h2>
<p>The diversity of flowering plants (the angiosperms) dwarfs the number of species of their closest evolutionary relatives (Figure 10.1). There are more than 260,000 species of angiosperms (that we know; more are added every day). The clade originated more than 140 million years ago <span class="citation">(Bell et al. <a href="#ref-Bell2005-sf">2005</a>)</span>, and all of these species have formed since then. One can contrast the diversity of angiosperms with the diversity of other groups that originated at around the same time. For example, gymnosperms, which are as old as angiosperms, include only around 1000 species, and may even represent more than one clade. The diversity of angiosperms also dwarfs the diversity of familiar vertebrate groups of similar age <span class="citation">(e.g. squamates - snakes and lizards - which diverged from their sister taxon, the tuatara, some 250 mya or more Hedges et al. <a href="#ref-Hedges2006-ta">2006</a>, include fewer than 8000 species)</span>.</p>
<p>The evolutionary rise of angiosperm diversity puzzled Darwin over his career, and the issues surrounding angiosperm diversification are often referred to as “Darwin’s abominable mystery” in the scientific literature <span class="citation">(e.g. Davies et al. <a href="#ref-Davies2004-dl">2004</a>)</span>. The main mystery is the tremendous variation in numbers of species across plant clades (see Figure 10.1). This variation even applies within angiosperms, where some clades are much more diverse than others.</p>
<p>At a global scale, the number of species in a clade can change only via two processes: speciation and extinction. This means that we must look to speciation and extinction rates – and how they vary through time and across clades – to explain phenomena like the extraordinary diversity of Angiosperms. It is to this topic that we turn in the next few chapters. Since Darwin’s time, we have learned a lot about the evolutionary processes that led to the diversity of angiosperms that we see today. These data provide an incredible window into the causes and effects of speciation and extinction over macroevolutionary time scales.</p>
<div class="figure">
<img src="{{site.baseurl}}/images/figure10-1.png" alt="Figure 10.1. Diversity of major groups of embryophytes (land plants); bar areas are proportional to species diversity of each clade. Angiosperms, including some 250,000 species, comprise more than 90% of species of land plants. Figure modified from Crepet and Niklas (2009)" />
<p class="caption">Figure 10.1. Diversity of major groups of embryophytes (land plants); bar areas are proportional to species diversity of each clade. Angiosperms, including some 250,000 species, comprise more than 90% of species of land plants. Figure modified from <span class="citation">Crepet and Niklas (<a href="#ref-Crepet2009-qf">2009</a>)</span></p>
</div>
<p>Comparative methods can be applied to understand patterns of species richness by estimating speciation and extinction rates, both across clades and through time. In this chapter, I will introduce birth-death models, by far the most common model for understanding diversification in a comparative framework. I will discuss the mathematics of birth-death models and how these models relate to the shapes of phylogenetic trees. I will describe how to simulate phylogenetic trees under a birth-death model. Finally, I will discuss tree balance and lineage-through-time plots, two common ways to measure the shapes of phylogenetic trees.</p>
<h2 id="section-10.2-the-birth-death-model">Section 10.2: The birth-death model</h2>
<p>A birth-death model is a continuous-time Markov process that is often used to study how the number of individuals in a population change through time. For macroevolution, these “individuals” are usually species, sometimes called &quot;lineages&quot; in the literature. In a birth-death model, two things can occur: births, where the number of individuals increases by one; and deaths, where the number of individuals decreases by one. We assume that no more than one new individual can form (or die) during any one event. In phylogenetic terms, that means that birth-death trees cannot have “hard polytomies” - each speciation event results in exactly two descendant species.</p>
<p>In macroevolution, we apply the birth-death model to species, and typically consider a model where each species has a constant probability of either giving birth (speciating) or dying (going extinct). We denote the per-lineage birth rate as <span class="math inline"><em>λ</em></span> and the per-lineage death rate as <span class="math inline"><em>μ</em></span>. For now we consider these rates to be constant, but we will relax that assumption later in the book.</p>
<p>We can understand the behavior of birth-death models if we consider the waiting time between successive speciation and extinction events in the tree. Imagine that we are considering a single lineage that exists at time <span class="math inline"><em>t</em><sub>0</sub></span>. We can think about the waiting time to the next event, which will either be a speciation event splitting that lineage into two (Figure 10.2A) or an extinction event marking the end of that lineage (Figure 10.2B). Under a birth-death model, both of these events follow a Poisson process, so that the expected waiting time to an event follows an exponential distribution (Figure 10.2C). The expected waiting time to the next speciation event is exponential with parameter <span class="math inline"><em>λ</em></span>, and the expected waiting time to the next extinction event exponential with parameter <span class="math inline"><em>μ</em></span>. [Of course, only one of these can be the next event. The expected waiting time to the next event (of any sort) is exponential with parameter <span class="math inline"><em>λ</em> + <em>μ</em></span>, and the probability that that event is speciation is <span class="math inline"><em>λ</em>/(<em>μ</em> + <em>λ</em>)</span>, extinction <span class="math inline"><em>μ</em>/(<em>μ</em> + <em>λ</em>)</span>].</p>
<div class="figure">
<img src="{{site.baseurl}}/images/figure10-2.png" alt="Figure 10.2. Illustration of the basic properties of birth-death models. A. Waiting time to a speciation event; B. Waiting time to an extinction event; C. Exponential distribution of waiting times until the next event; D. A birth-death tree with waiting times, with x denoting extinct taxa." />
<p class="caption">Figure 10.2. Illustration of the basic properties of birth-death models. A. Waiting time to a speciation event; B. Waiting time to an extinction event; C. Exponential distribution of waiting times until the next event; D. A birth-death tree with waiting times, with x denoting extinct taxa.</p>
</div>
<p>When we have more than one lineage “alive” in the tree at any time point, then the waiting time to the next event changes, although its distribution is still exponential. In general, if there are <span class="math inline"><em>N</em>(<em>t</em>)</span> lineages alive at time <span class="math inline"><em>t</em></span>, then the waiting time to the next event follows an exponential distribution with parameter <span class="math inline"><em>N</em>(<em>t</em>)(<em>λ</em> + <em>μ</em>)</span>, with the probability that that event is speciation or extinction the same as given above. You can see from this equation that the rate parameter of the exponential distribution gets larger as the number of lineages increases. This means that the expected waiting times across all lineages get shorter and shorter as more lineages accumulate.</p>
<p>Using this approach, we can grow phylogenetic trees of any size (Figure 10.2D).</p>
<p>We can derive some important properties of the birth-death process on trees. To do so, it is useful to define two additional parameters, the net diversification rate (<span class="math inline"><em>r</em></span>) and the relative extinction rate (<span class="math inline"><em>ϵ</em></span>):</p>
(eq. 10.1)
<div>
<p><br /><span class="math display"><em>r</em> = <em>λ</em> − <em>μ</em></span><br /></p>
</div>
<div>
<p><br /><span class="math display">$$
\epsilon = \frac{\mu}{\lambda}
$$</span><br /></p>
</div>
<p>These two parameters simplify some of the equations below, and are also commonly encountered in the literature.</p>
<p>To derive some general properties of the birth-death model, we first consider the process over a small interval of time, <span class="math inline"><em>Δ</em><em>t</em></span>. We assume that this interval is so short that it contains at most a single event, either speciation or extinction (the interval might also contain no events at all). The probability of speciation and extinction over the time interval can be expressed as:</p>
(eq. 10.2)
<div>
<p><br /><span class="math display"><em>P</em><em>r</em><sub><em>s</em><em>p</em><em>e</em><em>c</em><em>i</em><em>a</em><em>t</em><em>i</em><em>o</em><em>n</em></sub> = <em>N</em>(<em>t</em>)<em>λ</em><em>Δ</em><em>t</em></span><br /></p>
</div>
<div>
<p><br /><span class="math display"><em>P</em><em>r</em><sub><em>e</em><em>x</em><em>t</em><em>i</em><em>n</em><em>c</em><em>t</em><em>i</em><em>o</em><em>n</em></sub> = <em>N</em>(<em>t</em>)<em>μ</em><em>Δ</em><em>t</em></span><br /></p>
</div>
<p>We now consider the total number of living species at some time <span class="math inline"><em>t</em></span>, and write this as <span class="math inline"><em>N</em>(<em>t</em>)</span>. It is useful to think about the expected value of <span class="math inline"><em>N</em>(<em>t</em>)</span> under a birth-death model [we consider the full distribution of <span class="math inline"><em>N</em>(<em>t</em>)</span> below]. The expected value of <span class="math inline"><em>N</em>(<em>t</em>)</span> after a small time interval <span class="math inline"><em>Δ</em><em>t</em></span> is:</p>
(eq. 10.3)
<div>
<p><br /><span class="math display"><em>N</em>(<em>t</em> + <em>Δ</em><em>t</em>)=<em>N</em>(<em>t</em>)+<em>N</em>(<em>t</em>)<em>λ</em><em>Δ</em><em>t</em> − <em>N</em>(<em>t</em>)<em>μ</em><em>Δ</em><em>t</em></span><br /></p>
</div>
<p>We can convert this to a differential equation by subtracting <span class="math inline"><em>N</em>(<em>t</em>)</span> from both sides, then dividing by <span class="math inline"><em>Δ</em><em>t</em></span> and taking the limit as <span class="math inline"><em>Δ</em><em>t</em></span> becomes very small:</p>
(eq. 10.4)
<div>
<p><br /><span class="math display"><em>d</em><em>N</em>/<em>d</em><em>t</em> = <em>N</em>(<em>λ</em> − <em>μ</em>)</span><br /></p>
</div>
<p>We can solve this differential equation if we set a boundary condition that <span class="math inline"><em>N</em>(0)=<em>n</em><sub>0</sub></span>; that is, at time <span class="math inline">0</span>, we start out with <span class="math inline"><em>n</em><sub>0</sub></span> lineages. We then obtain:</p>
(eq. 10.5)
<div>
<p><br /><span class="math display"><em>N</em>(<em>t</em>)=<em>n</em><sub>0</sub><em>e</em><sup><em>λ</em> − <em>μ</em></sup><em>t</em> = <em>n</em><sub>0</sub><em>e</em><sup><em>r</em><em>t</em></sup></span><br /></p>
</div>
<p>This deterministic equation gives us the expected value for the number of species through time under a birth-death model. Notice that the number of species grows exponentially through time as long as <span class="math inline"><em>λ</em> &gt; <em>μ</em></span>, e.g. <span class="math inline"><em>r</em> &gt; 0</span>, and decays otherwise (Figure 10.3).</p>
<div class="figure">
<img src="{{site.baseurl}}/images/figure10-3.png" alt="Figure 10.3. Expected number of species under a birth-death model with r=\lambda-\mu &gt; 0 (top line), r = 0 (middle line), and r &lt; 0 (bottom line). In each case the starting number of species was n_0 = 1000." />
<p class="caption">Figure 10.3. Expected number of species under a birth-death model with <span class="math inline"><em>r</em> = <em>λ</em> − <em>μ</em> &gt; 0</span> (top line), <span class="math inline"><em>r</em> = 0</span> (middle line), and <span class="math inline"><em>r</em> &lt; 0</span> (bottom line). In each case the starting number of species was <span class="math inline"><em>n</em><sub>0</sub> = 1000</span>.</p>
</div>
<p>We are also interested in the stochastic behavior of the model – that is, how much should we expect <span class="math inline"><em>N</em>(<em>t</em>)</span> to vary from one replicate to the next? We can calculate the full probability distribution for <span class="math inline"><em>N</em>(<em>t</em>)</span>, which we write as <span class="math inline"><em>p</em><sub><em>n</em></sub>(<em>t</em>)=<em>P</em><em>r</em>[<em>N</em>(<em>t</em>)=<em>n</em>]</span> for all <span class="math inline"><em>n</em> ≥ 0</span>, to completely describe the birth-death model’s behavior. To derive this probability distribution, we can start with a set of equations, one for each value of <span class="math inline"><em>n</em></span>, to keep track of the probabilities of <span class="math inline"><em>n</em></span> lineages alive at time <span class="math inline"><em>t</em></span>. We will denote each of these as <span class="math inline"><em>p</em><sub><em>n</em></sub>(<em>t</em>)</span> (there are an infinite set of such equations, from <span class="math inline"><em>p</em><sub>0</sub></span> to <span class="math inline"><em>p</em><sub>∞</sub></span>). We can then write a set of difference equations that describe the different ways that one can reach any state over some small time interval <span class="math inline"><em>Δ</em><em>t</em></span>. We again assume that <span class="math inline"><em>Δ</em><em>t</em></span> is sufficiently small that at most one event (a birth or a death) can occur. As an example, consider what can happen to make <span class="math inline"><em>n</em> = 0</span> at the end of a certain time interval. There are two possibilities: either we were already at <span class="math inline"><em>n</em> = 0</span> at the beginning of the time interval and (by definition) nothing happened, or we were at <span class="math inline"><em>n</em> = 1</span> and the last surviving lineage went extinct. We write this as:</p>
(eq. 10.6)
<div>
<p><br /><span class="math display"><em>p</em><sub>0</sub>(<em>t</em> + <em>Δ</em><em>t</em>)=<em>p</em><sub>1</sub>(<em>t</em>)<em>μ</em><em>Δ</em><em>t</em> + <em>p</em><sub>0</sub>(<em>t</em>)</span><br /></p>
</div>
<p>Similarly, we can reach <span class="math inline"><em>n</em> = 1</span> by either starting with <span class="math inline"><em>n</em> = 1</span> and having no events, or going from <span class="math inline"><em>n</em> = 2</span> via extinction.</p>
(eq. 10.7)
<div>
<p><br /><span class="math display"><em>p</em><sub>1</sub>(<em>t</em> + <em>Δ</em><em>t</em>)=<em>p</em><sub>1</sub>(<em>t</em>)(1 − (<em>λ</em> + <em>μ</em>))<em>Δ</em><em>t</em> + <em>p</em><sub>2</sub>(<em>t</em>)2<em>μ</em><em>Δ</em><em>t</em></span><br /></p>
</div>
<p>Finally, any <span class="math inline"><em>n</em> &gt; 1</span>, we can reach the state of <span class="math inline"><em>n</em></span> lineages in three ways: from a birth (from <span class="math inline"><em>n</em> − 1</span> to <span class="math inline"><em>n</em></span>), a death (from <span class="math inline"><em>n</em> + 1</span> to <span class="math inline"><em>n</em></span>), or neither (from <span class="math inline"><em>n</em></span> to <span class="math inline"><em>n</em></span>).</p>
(eq. 10.8)
<div>
<p><br /><span class="math display"><em>p</em><sub><em>n</em></sub>(<em>t</em> + <em>Δ</em><em>t</em>)=<em>p</em><sub><em>n</em> − 1</sub>(<em>t</em>)(<em>n</em> − 1)<em>λ</em><em>Δ</em><em>t</em> + <em>p</em><sub><em>n</em> + 1</sub>(<em>t</em>)(<em>n</em> + 1)<em>μ</em><em>Δ</em><em>t</em> + <em>p</em><sub><em>n</em></sub>(<em>t</em>)(1 − <em>n</em>(<em>λ</em> + <em>μ</em>))<em>Δ</em><em>t</em></span><br /></p>
</div>
<p>We can convert this set of difference equations to differential equations by subtracting <span class="math inline"><em>p</em><sub><em>n</em></sub>(<em>t</em>)</span> from both sides, then dividing by <span class="math inline"><em>Δ</em><em>t</em></span> and taking the limit as <span class="math inline"><em>Δ</em><em>t</em></span> becomes very small. So, when <span class="math inline"><em>n</em> = 0</span>, we use 10.6 to obtain:</p>
(eq. 10.9)
<div>
<p><br /><span class="math display"><em>d</em><em>p</em><sub>0</sub>(<em>t</em>)/<em>d</em><em>t</em> = <em>μ</em><em>p</em><sub>1</sub>(<em>t</em>)</span><br /></p>
</div>
<p>From 10.7:</p>
(eq. 10.10)
<div>
<p><br /><span class="math display"><em>d</em><em>p</em><sub>1</sub>(<em>t</em>)/<em>d</em><em>t</em> = 2<em>μ</em><em>p</em><sub>2</sub>(<em>t</em>)−(<em>λ</em> − <em>μ</em>)<em>p</em><sub>1</sub>(<em>t</em>)</span><br /></p>
</div>
<p>and from 10.8, for all <span class="math inline"><em>n</em> &gt; 1</span>:</p>
(eq. 10.11)
<div>
<p><br /><span class="math display"><em>d</em><em>p</em><sub><em>n</em></sub>(<em>t</em>)/<em>d</em><em>t</em> = (<em>n</em> − 1)<em>λ</em><em>p</em><sub><em>n</em> − 1</sub>(<em>t</em>)+(<em>n</em> + 1)<em>μ</em><em>p</em><sub><em>n</em> + 1</sub>(<em>t</em>)−<em>n</em>(<em>λ</em> + <em>μ</em>)<em>p</em><sub><em>n</em></sub>(<em>t</em>)</span><br /></p>
</div>
<p>We can then solve this set of differential equations to obtain the probability distribution of <span class="math inline"><em>p</em><sub><em>n</em></sub>(<em>t</em>)</span>. Using the same boundary condition, <span class="math inline"><em>N</em>(0)=<em>n</em><sub>0</sub></span>, we have <span class="math inline"><em>p</em><sub>0</sub>(<em>t</em>)=1</span> for <span class="math inline"><em>n</em> = <em>n</em><sub>0</sub></span> and 0 otherwise. Then, we can find the solution to the differential equations 10.9, 10.10, and 10.11. The derivation of the solution to this set of differential equations is beyond the scope of this book <span class="citation">(but see Kot <a href="#ref-Kot2001-va">2001</a> for a nice explanation of the mathematics)</span>. A solution was first obtained by Bailey <span class="citation">(<a href="#ref-Bailey1964-ka">1964</a>)</span>, but I will use the simpler equivalent form from Foote et al. <span class="citation">(<a href="#ref-Foote1999-rq">1999</a>)</span>. For <span class="math inline"><em>p</em><sub>0</sub>(<em>t</em>)</span> – that is, the probability that the entire lineage has gone extinct at time t – we have:</p>
(eq. 10.12)
<div>
<p><br /><span class="math display"><em>p</em><sub>0</sub>(<em>t</em>)=<em>α</em><sub>0</sub><sup><em>n</em></sup></span><br /></p>
</div>
<p>And for all <span class="math inline"><em>n</em> ≥ 1</span>:</p>
(eq. 10.13)
<div>
<p><br /><span class="math display">$$
p_n(t) = \sum\limits_{j=1}^{min(n_0,n)} \binom{n_0}{j} \binom{n-1}{j-1} \alpha^{n_0 - j} \beta^{n-j} [(1-\alpha)(1-\beta)]^j
$$</span><br /></p>
</div>
<p>Where <span class="math inline"><em>α</em></span> and <span class="math inline"><em>β</em></span> are defined as:</p>
(eq. 10.14)
<div>
<p><br /><span class="math display">$$
\alpha=\frac{\epsilon (e^rt-1)}{(e^rt-\epsilon)}
$$</span><br /></p>
</div>
<div>
<p><br /><span class="math display">$$
\beta =\frac{(e^rt-1)}{(e^rt-\epsilon)}
$$</span><br /></p>
</div>
<p><span class="math inline"><em>α</em></span> is the probability that any particular lineage has gone extinct before time <span class="math inline"><em>t</em></span>.</p>
<p>Note that when <span class="math inline"><em>n</em><sub>0</sub> = 1</span> – that is, when we start with a single lineage - equations 10.12 and 10.13 simplify to <span class="citation">(Raup <a href="#ref-Raup1985-wn">1985</a>)</span>:</p>
(eq. 10.15)
<div>
<p><br /><span class="math display"><em>p</em><sub>0</sub>(<em>t</em>)=<em>α</em></span><br /></p>
</div>
<p>And for all <span class="math inline"><em>n</em> ≥ 1</span>:</p>
(eq. 10.16)
<div>
<p><br /><span class="math display"><em>p</em><sub><em>n</em></sub>(<em>t</em>)=(1 − <em>α</em>)(1 − <em>β</em>)<em>β</em><sup><em>i</em> − 1</sup></span><br /></p>
</div>
<p>In all cases the expected number of lineages in the tree is exactly as stated above in equation (10.5), but now we have the full probability distribution of the number of lineages given <span class="math inline"><em>n</em><sub>0</sub></span>, <span class="math inline"><em>t</em></span>, <span class="math inline"><em>λ</em></span>, and <span class="math inline"><em>μ</em></span>. A few plots capture the general shape of this distribution (Figure 10.4).</p>
<div class="figure">
<img src="{{site.baseurl}}/images/figure10-4.png" alt="Figure 10.4. Probability distributions of N(t) under A. pure birth, B. birth death after a short time, and C. birth-death after a long time." />
<p class="caption">Figure 10.4. Probability distributions of N(t) under A. pure birth, B. birth death after a short time, and C. birth-death after a long time.</p>
</div>
<p>There are quite a few comparative methods that use clade species richness and age along with the distribution defined in 10.14 and 10.15 to make inferences about clade diversification rates (see chapter 11).</p>
<h2 id="section-10.3-birth-death-models-and-phylogenetic-trees">Section 10.3: Birth-death models and phylogenetic trees</h2>
<p>The above discussion considered the number of lineages under a birth-death model, but not their phylogenetic relationships. However, just by keeping track of the parent-offspring relationships among lineages, we can consider birth-death models that result in phylogenetic trees (e.g. Figure 10.2D).</p>
<p>The main complication in phylogenetic studies of birth-death models is that we get a “censored” view of the process, in that we only observe lineages that survive to the present day. In the above example, if the true phylogenetic tree were the one plotted in 10.5A, we would only have a chance to observe the phylogenetic tree in figure 10.5B – and even then only if we sampled all of the species and reconstructed the tree with perfect accuracy! A partially sampled tree with only extant species can be seen in Figure 10.5C. I will cover the relationship between birth-death models and the branch lengths of phylogenetic trees in much more detail in the next chapter.</p>
<div class="figure">
<img src="{{site.baseurl}}/images/figure10-5.png" alt="Figure 10.5. A. A birth-death tree including all extinct and extant species; B. A birth-death tree including only extant species; and C. A partially sampled birth-death tree including only some extant species." />
<p class="caption">Figure 10.5. A. A birth-death tree including all extinct and extant species; B. A birth-death tree including only extant species; and C. A partially sampled birth-death tree including only some extant species.</p>
</div>
<h2 id="section-10.4-simulating-birth-death-trees">Section 10.4: Simulating birth-death trees</h2>
<p>We can use the statistical properties of birth-death models to simulate phylogenetic trees through time. We could begin with a single lineage at time 0. However, phylogenetic tree often start with the first speciation event in the clade, so one can also begin the simulation with two lineages at time 0 (this distinction relates to our earlier discussion of crown versus stem ages; see also <a href="{{site.baseurl}}/chapter11_fitbd/">Chapter 11</a>).</p>
<p>To simulate our tree, we need to draw waiting times between speciation and extinction events, connect new lineages to the tree, and prune lineages when they go extinct. We also need a stopping criterion, which can have to do with a particular number of taxa or a fixed time interval. We will consider the latter, and leave growing trees to a fixed number of taxa as an exercise for the reader. Our simulation algorithm is as follows. I assume that we have a certain number of “living” lineages in our tree (1 or 2 initially), a current time (<span class="math inline"><em>t</em><sub><em>c</em></sub> = 0</span> initially), and a stopping time <span class="math inline"><em>t</em><sub><em>s</em><em>t</em><em>o</em><em>p</em></sub></span>.</p>
<ol style="list-style-type: decimal">
<li>Draw a waiting time <span class="math inline"><em>t</em><sub><em>i</em></sub></span> to the next speciation or extinction event. Waiting times are drawn from an exponential distribution with rate parameter <span class="math inline"><em>N</em><sub><em>a</em><em>l</em><em>i</em><em>v</em><em>e</em></sub> * (<em>λ</em> + <em>μ</em>)</span> where <span class="math inline"><em>N</em><sub><em>a</em><em>l</em><em>i</em><em>v</em><em>e</em></sub></span> is the current number of living lineages in the tree.</li>
<li>Check to see if the simulation ends before the next event. That is, if <span class="math inline"><em>t</em><sub><em>c</em></sub> + <em>t</em><sub><em>i</em></sub> &gt; <em>t</em><sub><em>s</em><em>t</em><em>o</em><em>p</em></sub></span>, end the simulation.</li>
<li>Decide whether the next event is a speciation event [with probability <span class="math inline"><em>λ</em>/(<em>λ</em> + <em>μ</em>)</span>] or an extinction event [with probability <span class="math inline"><em>μ</em>/(<em>λ</em> + <em>μ</em>)</span>]. This can be done by drawing a uniform random number <span class="math inline"><em>u</em><sub><em>i</em></sub></span> from the interval <span class="math inline">[0, 1]</span> and assigning speciation to the event if <span class="math inline"><em>u</em><sub><em>i</em></sub> &lt; <em>λ</em>/(<em>λ</em> + <em>μ</em>)</span> and extinction otherwise.</li>
<li>If (3) is a speciation event, then choose a random living lineage in the tree. Attach a new branch to the tree at this point, and add one new living lineage to the simulation. Return to step 1.</li>
<li>If (3) is an extinction event, choose a random living lineage in the tree. That lineage is now dead. As long as there is still at least one living lineage in the tree, return to (1); otherwise, your whole clade has gone extinct, and you can stop the simulation.</li>
</ol>
<p>This procedure returns a phylogenetic tree that includes both living and dead lineages. One can prune out any extinct taxa to return a birth-death tree of survivors, which is more in line with what we typically study using extant species. It is also worth noting that entire clades can – and often do – go extinct under this protocol before one reaches time <span class="math inline"><em>t</em><sub><em>s</em><em>t</em><em>o</em><em>p</em></sub></span>. Note also that there is a much more efficient way to simulate trees <span class="citation">(Stadler <a href="#ref-Stadler2011-xu">2011</a>)</span>.</p>
<p>We can think about phylogenetic predictions of birth-death models in two ways: by considering tree topology, and by considering tree branch lengths. I will consider each of these two aspects of trees below.</p>
<h2 id="section-10.5-tree-topology-tree-shape-and-tree-balance-under-a-birth-death-model">Section 10.5: Tree topology, tree shape, and tree balance under a birth-death model</h2>
<p>Tree topology summarizes the patterns of evolutionary relatedness among a group of species independent of the branch lengths of a phylogenetic tree. Two different trees have the same topology if they define the exact same set of clades. This is important because sometimes two trees can look very different and yet still have the same topology (e.g. Figure 10.6 A, B, and C).</p>
<div class="figure">
<img src="{{site.baseurl}}/images/figure10-6.png" alt="Figure 10.6. Several phylogenetic trees showing different ways to plot the same tree topology." />
<p class="caption">Figure 10.6. Several phylogenetic trees showing different ways to plot the same tree topology.</p>
</div>
<p>Tree shape ignores both branch lengths and tree tip labels. For example, the two trees in figure 10.7 A and B have the same tree shape even though they share no tips in common. What they do share is that their nodes have the same patterns in terms of the number of descendants on each “side” of the bifurcation. By contrast, the phylogenetic tree in 10.7 C has a different shape. <span class="citation">(Note that what I am calling tree shape is sometimes referred to as “unlabeled” tree topology; e.g. Felsenstein <a href="#ref-Felsenstein2004-eo">2004</a>)</span>.</p>
<div class="figure">
<img src="{{site.baseurl}}/images/figure10-7.png" alt="Figure 10.7. Two different phylogenetic trees sharing the same tree shape (A and B), and one with a different shape (C)." />
<p class="caption">Figure 10.7. Two different phylogenetic trees sharing the same tree shape (A and B), and one with a different shape (C).</p>
</div>
<p>Finally, tree balance is a way of expressing differences in the number of descendants between pairs of sister lineages at different points in a phylogenetic tree. For example, consider the phylogenetic tree depicted in figure 10.7B. The deepest split in that tree separates a clade with five species (trout, hippo, bluejay, periwinkle snail, glass squid) from a clade with a single species (Shiitake mushroom), and so that node in the tree is unbalanced with a (5, 1) pattern. By contrast, the deepest split in 10.7C separates two clades of equal size. In that tree, the deepest node is balanced with a (3, 3) pattern. A number of approaches in macroevolution use balance at nodes and across whole trees to try to capture important evolutionary patterns.</p>
<p>We can start to understand these approaches by considering the balance of a single node <span class="math inline"><em>n</em></span> in a phylogenetic tree. There are two clades descended from this node; let’s call them <span class="math inline"><em>a</em></span> and <span class="math inline"><em>b</em></span>. We assume that the total number of species descended from the node <span class="math inline"><em>N</em><sub><em>t</em><em>o</em><em>t</em><em>a</em><em>l</em></sub></span> = <span class="math inline"><em>N</em><sub><em>a</em></sub> + <em>N</em><sub><em>b</em></sub></span> is constant and that neither <span class="math inline"><em>N</em><sub><em>a</em></sub></span> nor <span class="math inline"><em>N</em><sub><em>b</em></sub></span> is zero. An important result, first discussed by Farris <span class="citation">(<a href="#ref-Farris1976-ck">1976</a>)</span> for a pure-birth model, is that all possible numerical divisions of <span class="math inline"><em>N</em><sub><em>t</em><em>o</em><em>t</em><em>a</em><em>l</em></sub></span> into <span class="math inline"><em>N</em><sub><em>a</em></sub> + <em>N</em><sub><em>b</em></sub></span> are equally probable. For example, if <span class="math inline"><em>N</em><sub><em>t</em><em>o</em><em>t</em><em>a</em><em>l</em></sub> = 10</span>, then all possible divisions: <span class="math inline">1 + 9</span>, <span class="math inline">2 + 8</span>, <span class="math inline">3 + 7</span>, <span class="math inline">4 + 6</span>, <span class="math inline">5 + 5</span>, <span class="math inline">6 + 4</span>, <span class="math inline">7 + 3</span>, <span class="math inline">8 + 2</span>, and <span class="math inline">9 + 1</span> are all equally probable, so that each will be predicted to occur with a probability 1/9. Formally,</p>
(eq. 10.17)
<div>
<p><br /><span class="math display">$$
p(N_a \mid N_{total})=\frac{1}{N_{total}-1}
$$</span><br /></p>
</div>
<p>Note that there is a subtle difference between equation 10.2 above and some equations in the literature, e.g. Slowinski and Guyer <span class="citation">(<a href="#ref-Slowinski1993-ks">1993</a>)</span>. This difference has to do with whether we label the two descendent clades, a and b, or not; if the clades are unlabeled, then there is no difference between 4+6 and 6+4, so that the probability that the largest clade, whichever it might be, has 6 species is twice what is given by my equation.</p>
<p>Equation 10.17 applies even if there is extinction, as long as both sister clades have the same speciation and extinction rates <span class="citation">(Slowinski and Guyer <a href="#ref-Slowinski1993-ks">1993</a>)</span>. This equation has been used to compare diversification rates between sister clades, either for a single pair or across multiple pairs (see Chapter 11).</p>
<p>Tree balance statistics provide a way of comparing numbers of taxa across all of the nodes in a phylogenetic tree simultaneously. There are a surprisingly large number of tree balance statistics, but all rely on summarizing information about the balance of each node across a whole tree. Colless’ index <span class="math inline"><em>I</em><sub><em>c</em></sub></span> <span class="citation">(Colless <a href="#ref-Colless1982-kz">1982</a>)</span> is one of the simplest – and, perhaps, most commonly used – indices of tree balance. <span class="math inline"><em>I</em><sub><em>c</em></sub></span> is the sum of the difference in the number of tips subtended on each side of every node in the tree, standardized by the maximum that such a sum can achieve:</p>
(eq. 10.18)
<div>
<p><br /><span class="math display">$$
I_C = \frac{\sum\limits_{all nodes} (N_L - N_R)}{(N-1)(N-2)/2}
$$</span><br /></p>
</div>
<p>If the tree is perfectly balanced (only possible when <span class="math inline"><em>N</em></span> is some power of 2, e.g. 2, 4, 8, 16, etc.), then <span class="math inline"><em>I</em><sub><em>C</em></sub></span> = 0 (Figure 10.7C). By contrast, if the tree is completely pectinate, which means that each split in the tree contrasts a clade with 1 species with the rest of the species in the clade, then <span class="math inline"><em>I</em><sub><em>C</em></sub> = 1</span> (Figure 10.7A). Most phylogenetic trees have values of <span class="math inline"><em>I</em><sub><em>C</em></sub></span> between 0 and 1 (Figure 10.7B).</p>
<div class="figure">
<img src="{{site.baseurl}}/images/figure10-8.png" alt="Figure 10.8. A. a pectinate tree (I_C = 1); B. a random tree (0 &lt; I_C &lt; 1); C. A balanced tree (I_C = 0)." />
<p class="caption">Figure 10.8. A. a pectinate tree (<span class="math inline"><em>I</em><sub><em>C</em></sub> = 1</span>); B. a random tree (<span class="math inline">0 &lt; <em>I</em><sub><em>C</em></sub> &lt; 1</span>); C. A balanced tree (<span class="math inline"><em>I</em><sub><em>C</em></sub> = 0</span>).</p>
</div>
<p>There are a number of other indices of phylogenetic tree balance <span class="citation">(reviewed in Mooers and Heard <a href="#ref-Mooers1997-ow">1997</a>)</span>. All of these indices are used in a similar way: one can then compare the value of the tree index to what one might expect under a particular model of diversification, typically birth-death. In fact, since these indices focus on tree topology and ignore branch lengths, one can actually consider their general behavior under a set of equal-rates Markov (ERM) models. This set includes any model where birth and death rates are equal across all lineages in a phylogenetic tree at a particular time. ERM models include birth-death models as described above, but also encompass models where birth and/or death rates change through time.</p>
<h2 id="section-10.6-lineage-through-time-plots">Section 10.6: Lineage-through-time plots</h2>
<p>The other main way to quantify phylogenetic tree shape is by making lineage-through-time plots. These plots have time along the x axis (from the root of the tree to the present day), and the reconstructed number of lineages on the y-axis (Figure 10.8). Since we are usually considering birth-death models, where the number of lineages is expected to grow (or shrink) exponentially through time, then it is typical practice to log-transform the y-axis.</p>
<div class="figure">
<img src="{{site.baseurl}}/images/figure10-9.png" alt="Figure 10.9. Lineage-through-time plot." />
<p class="caption">Figure 10.9. Lineage-through-time plot.</p>
</div>
<p>Lineage-through-time plots are effective ways to visualize patterns of lineage diversification through time. Under a pure-birth model, LTT plots follow a straight line on average (Figure 10.9A). By contrast, extinction should leave a clear signal in LTT plots because the probability of a lineage going extinct depends on how long it has been around; old lineages are much more likely to have been hit by extinction than relatively young lineages. We see this reflected in LTT plots as the “pull of the present” – an upturn in the slope of the LTT plot near the present day (Figure 10.9B). Incomplete sampling – that is, not sampling all of the living species in a clade – can also have a huge impact on the shape of LTT plots (Figure 10.9C). We will discuss LTT plots further in chapter 11, where we will use them to make inferences about patterns of lineage diversification through time.</p>
<div class="figure">
<img src="{{site.baseurl}}/images/figure10-10.png" alt="Figure 10.10. Example lineage-through-time plots." />
<p class="caption">Figure 10.10. Example lineage-through-time plots.</p>
</div>
<h2 id="section-10.7-chapter-summary">Section 10.7: Chapter Summary</h2>
<p>In this chapter, I introduced birth-death models and summarized their basic mathematical properties. Birth-death models predict patterns of species diversity over time intervals, and can also be used to model the growth of phylogenetic trees. We can visualize these patterns by measuring tree balance and creating lineage-through-time (LTT) plots.</p>
<h2 id="references" class="unnumbered">References</h2>
<div id="refs" class="references">
<div id="ref-Bailey1964-ka">
<p>Bailey, N. T. J. 1964. The elements of stochastic processes with applications to the natural sciences. John Wiley &amp; Sons.</p>
</div>
<div id="ref-Bell2005-sf">
<p>Bell, C. D., D. E. Soltis, and P. S. Soltis. 2005. The age of the angiosperms: A molecular timescale without a clock. Evolution 59:1245–1258.</p>
</div>
<div id="ref-Colless1982-kz">
<p>Colless, D. H. 1982. Review of phylogenetics: The theory and practice of phylogenetic systematics. Syst. Zool.</p>
</div>
<div id="ref-Crepet2009-qf">
<p>Crepet, W. L., and K. J. Niklas. 2009. Darwin’s second “abominable mystery”: Why are there so many angiosperm species? Am. J. Bot. Botanical Soc America.</p>
</div>
<div id="ref-Davies2004-dl">
<p>Davies, T. J., T. G. Barraclough, M. W. Chase, P. S. Soltis, D. E. Soltis, and V. Savolainen. 2004. Darwin’s abominable mystery: Insights from a supertree of the angiosperms. Proc. Natl. Acad. Sci. U. S. A. 101:1904–1909.</p>
</div>
<div id="ref-Farris1976-ck">
<p>Farris, J. S. 1976. Expected asymmetry of phylogenetic trees. Syst. Zool. 25:196–198. [Oxford University Press, Society of Systematic Biologists, Taylor &amp; Francis, Ltd.].</p>
</div>
<div id="ref-Felsenstein2004-eo">
<p>Felsenstein, J. 2004. Inferring phylogenies. Sinauer Associates, Inc., Sunderland, MA.</p>
</div>
<div id="ref-Foote1999-rq">
<p>Foote, M., J. P. Hunter, C. M. Janis, and J. J. Sepkoski Jr. 1999. Evolutionary and preservational constraints on origins of biologic groups: Divergence times of eutherian mammals. Science 283:1310–1314.</p>
</div>
<div id="ref-Hedges2006-ta">
<p>Hedges, S. B., J. Dudley, and S. Kumar. 2006. TimeTree: A public knowledge-base of divergence times among organisms. Bioinformatics 22:2971–2972.</p>
</div>
<div id="ref-Kot2001-va">
<p>Kot, M. 2001. Stochastic birth and death processes. Pp. 25–42 <em>in</em> M. Kot, ed. Elements of mathematical ecology. Cambridge University Press, Cambridge.</p>
</div>
<div id="ref-Mooers1997-ow">
<p>Mooers, A. O., and S. B. Heard. 1997. Inferring evolutionary process from phylogenetic tree shape. Q. Rev. Biol. 72:31–54.</p>
</div>
<div id="ref-Raup1985-wn">
<p>Raup, D. M. 1985. Mathematical models of cladogenesis. Paleobiology 11:42–52.</p>
</div>
<div id="ref-Slowinski1993-ks">
<p>Slowinski, J. B., and C. Guyer. 1993. Testing whether certain traits have caused amplified diversification: An improved method based on a model of random speciation and extinction. Am. Nat. 142:1019–1024.</p>
</div>
<div id="ref-Stadler2011-xu">
<p>Stadler, T. 2011. Simulating trees with a fixed number of extant species. Syst. Biol. 60:676–684.</p>
</div>
</div>
</body>
</html>
